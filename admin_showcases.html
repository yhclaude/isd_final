<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="Description" Content="Learn more about programmatic technology, B2B advertising and campaign reporting.">
	<title>Open Lab</title>
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/bootstrap-table.css">
	<link href="css/style.css" rel="stylesheet">
	<link href="css/admin.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="https://jonthornton.github.io/jquery-timepicker/jquery.timepicker.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/css/bootstrap-datepicker.standalone.css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://jonthornton.github.io/jquery-timepicker/jquery.timepicker.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.0/js/bootstrap-datepicker.js"></script>
    <script src="js/datepair.js"></script>
    <script src="js/jquery.datepair.js"></script>
	
	<style type="text/css">
		#basicExample {
			margin-left: 60px;
		}
		#basicExample input {
			width: 82px;
			margin-left: 5px;
			height: 28px;
			padding: 6px;
			border-radius: 5px;
		}
	</style>
</head>
<body class="admin-body">
	<header class="header">
        <div class="head">
            <img class="logo" src="images/pitt-logo.png">
        </div>
    </header>
	<div class="upperRightButton">
		<button data-toggle="modal" data-target="#staffModal" type="button" class="btn btn-default">Update</button>
		<button data-toggle="modal" data-target="#staffModal" type="button" class="btn btn-default" onclick="switchMode()">Switch Mode</button>
	</div>
	    <div id="staffModal" class="modal fade" role="dialog">
		<div class="modal-dialog" role="document">
			<div class="modal-content login-modal" style="background-color: black; opacity: 0.95;">
				<div class="modal-header-close" style="padding:3%">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="font-size:24px; color: white;">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" style="padding: 5% 13%;">
					<form role="form">
						<div class="form-group">
							<label for="title" style="color: white;font-size: 22px;"><b>Hi, John!</b></label>
								<br /><br />
						</div>
						<div class="form-group">
							<label for="working hours" style="color:gray; font-size: 14px;">Working Hours</label>
								<br />
							<span style="padding-top:8%"><label style="color:white; font-size: 16px; float: left;">Hours</label>
							<p id="basicExample">
								    <input type="text" class="date start" />
								    <input type="text" class="time start" /> to
								    <input type="text" class="time end" />
								    <input type="text" class="date end" />
								</p>
								</span>
						</div>
						<br /><br />
						<div class="form-group">
							<span>
								<label for="working devices" style="color:gray; font-size: 14px;">Working Devices</label>
									<!-- <a href="#" style="color:white; font-size: 12px; float:right;"><u>Add</u></a> -->
							</span>
							<br />

							<span style="padding:8%"><label style="color:white; font-size: 16px; float: left;">Device</label>
								<select style="width: 75%">
										<option value="1">3D Printing</option>
										<option value="2">Virtual Reality</option>
										<option value="3">360° Video Camera & Viewer</option>
										<option value="4">360° Video Projector</option>
									</select>
							</span>
						</div>
							<br /><br />
						<div class="form-group">
							<label for="current event" style="color:gray; font-size: 14px;">Current Event</label>
							<div style="background: white; padding-top: 5px;padding-right: 15px;padding-bottom: 5px;padding-left: 15px;">
								<textarea class="form-control" rows="6" cols="80" name="current event" required></textarea>
							</div>
						</div>
						<div class="form-group">
							<div class="formButton" style="padding-top: 10px;padding-right: 120px;padding-bottom: 10px;padding-left: 120px;">
								<button type="button" class="btn btn-default" class="upperRightButton"style="color:white; background-color:#1c2957">Post</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="admin-page container">
		<div class="admin-header">
			Content Management
            <div class="addButton">
				<a href="admin_showcases_add.html" type="button" class="btn btn-default">Create Showcase</a>
			</div>
		</div>
		<div class="row admin-content">
			<div class="col-md-3 left-navbar">
				<ul class="left-navbar-menu">
					<li><a href="./admin_users.html" class="btn" role="button">Users</a></li>
					<li><a href="./admin_events.html" class="btn" role="button">Events</a></li>
					<li><a href="./admin_showcases.html" class="btn active" role="button">Showcases</a></li>
					<li><a href="admin_subscribes.html" class="btn" role="button">Subscribes</a></li>
					<li><a href="./admin_devices.html" class="btn" role="button">Devices</a></li>
					<li><a href="./admin_log.html" class="btn" role="button">Logs</a></li>

				</ul>
			</div>
			<div class="col-md-9 right-content">
				<ul class="right-content-ul">

				</ul>
				<div class="pull-right pagination">
					<ul class="pagination">
						<li class="page-item page-pre">
							<a disabled="true" class="btn page-link">‹</a>
						</li>
						<li class="page-item active">
							<a id="pageNumber" class="page-link">0</a>
						</li>
						<li class="page-item page-next">
							<a class="page-link btn">›</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div id="footer">
			<div class="row">
				<hr>
			</div>
			<div class="row col-8">
				<div class="col-8 col-offset-2 col-md-8 col-md-offset-2">

					<div class="col-sm-8 col-xs-8">
						<p><span data-feather="map-pin" style="width:14px; height:14px;"></span> 227 Fifth Avenue, Pittsburgh, PA 15260</p>
						<p><span data-feather="phone" style="width:14px; height:14px;"></span> 412-624-3335</p>
						<p><span data-feather="inbox" style="width:14px; height:14px;"></span> Email: teaching@pitt.edu</p>
					</div>

					<div class="col" id="login-button">
					</div>

				</div>
			</div>
		</div>
	</div>

<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap-table.min.js"></script>
<script src="js/bootstrap-table-en-US.js"></script>
<script src="js/switchMode.js"></script>
<script src="js/user.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		$('#basicExample .time').timepicker({
	        'showDuration': true,
	        'timeFormat': 'g:ia'
	    });

	    $('#basicExample .date').datepicker({
	        'format': 'm/d/yyyy',
	        'autoclose': true
	    });

	    // initialize datepair
	    var basicExampleEl = document.getElementById('basicExample');
	    var datepair = new Datepair(basicExampleEl);
		$('#pageNumber').data('offset',['']);

		// var cache = {}

		// ajax changePage
		function changePage(pages, url, type, asy = false) {
			var val = parseInt($('#pageNumber').html()) + pages;
			$('#pageNumber').html(val);
			if (val == 1) {
				$('.page-pre a').attr('disabled', 'true');
			} else {
				$('.page-pre a').removeAttr('disabled');
			}
			var getParams = {
				pageSize: 4,
				sess: 'rFIAeA83nEiBOMHCLY3zvRNJq0P8gLb8XXhYWg1oGSyutWVVYagLFO6Uooy8LhJrmhh7sIYRYqwPz9sMQpcLNg==',
				offset: $('#pageNumber').data('offset')[val-1]
			}
			$.ajax({
				url: url,
				type: type,
				data: getParams,
				async: asy,
				dataType:'json',
				success: function(res) {
					if(parseInt(res.code) == 200) {
						$('.page-next a').removeAttr('disabled');
						$('.right-content-ul').html('');
						$.each(res.data, function(i) {

							$li = $('<li></li>');
							$div1 = $('<div class="row"></div>');
							$div2 = $('<div class="row"></div>');
							$div3 = $('<div class="function-div"></div>');
							$divName = $('<div class="col-md-4">Title: </div>');
							$divWork = $('<div class="col-md-7">Author: </div>');
							$divEditDelete = $('<div class="col-md-1 showEditDelete"></div>');
							$divShowButton = $('<button type="button" class="btn btn-default"><span class="glyphicon glyphicon-option-vertical"></span></button>');
							$divStart = $('<div class="col-md-4">Time: </div>');
							$divEnd = $('<div class="col-md-8">Description: </div>');
							$divEdit = $('<div class="edit"></div>');
							$divDelete = $('<div class="delete"></div>');
							$divEditButton = $('<a type="button">Edit</a>');
							$divDeleteButton = $('<a type="button">Delete</a>');
							$('.right-content-ul').append($li);
							$('.right-content-ul').find('li').eq(i).append($div1).append($div2).append($div3);
							$('.right-content-ul').find('li').eq(i).find('div.row').eq(0).append($divName).append($divWork).append($divEditDelete);

							// name
							$('.right-content-ul').find('li').eq(i).find('div.row').eq(0).find('div.col-md-4').append('<span>' + res.data[i].fields.showcase_title + '</span>');

							// working_machine
							$('.right-content-ul').find('li').eq(i).find('div.row').eq(0).find('div.col-md-7').append('<span>' + res.data[i].fields.showcase_author + '</span>');
							$('.right-content-ul').find('li').eq(i).find('div.row').eq(0).find('div.col-md-1').append($divShowButton);

							$('.right-content-ul').find('li').eq(i).find('div.row').eq(1).append($divStart).append($divEnd);

							// start_time
							$('.right-content-ul').find('li').eq(i).find('div.row').eq(1).find('div.col-md-4').append('<span>' + res.data[i].fields.showcase_time + '</span>');

							// end_time
							$('.right-content-ul').find('li').eq(i).find('div.row').eq(1).find('div.col-md-8').append('<span>' + res.data[i].fields.showcase_description + '</span>');

							$('.right-content-ul').find('li').eq(i).find('div.function-div').append($divEdit).append($divDelete);
							$('.right-content-ul').find('li').eq(i).find('div.function-div').find('div').eq(0).append($divEditButton);
							$('.right-content-ul').find('li').eq(i).find('div.function-div').find('div').eq(1).append($divDeleteButton);


							// edit and delete with id
							$('.right-content-ul>li').eq(i).find('.function-div a').eq(0).attr('href','admin_showcases_edit.html?id='+res.data[i].id);
							$('.right-content-ul>li').eq(i).find('.function-div a').eq(1).attr('data',res.data[i].id);
							if (res.offset) {
								var offsetArr = $('#pageNumber').data('offset');
								offsetArr[$('#pageNumber').html()] = res.offset;
								$('#pageNumber').data('offset',offsetArr);
							} else {
								$('.page-next a').attr('disabled', 'true');
							}

						})
						// click show hide
						$('.right-content-ul > li').each(function(){
							$(this).find('.showEditDelete > button').click(function(e) {
								$(this).closest('li').find('.function-div').show();
								$(document).one("click", function(){
									$('.right-content-ul > li > .function-div').hide();
								});
								e.stopPropagation();

							});
							$(this).find('.function-div').click(function(e) {
								e.stopPropagation();
							})
						})
					}
					else {
						var val = parseInt($('#pageNumber').html()) - 1;
						$('#pageNumber').html(val);

					}
				},
				error: function(err) {
					console.log(err.responseText);
				}
			})
		}

		// next page api route
		$('.page-next a').click(function() {
			changePage(1, 'http://localhost/isd_final/connection/index.php/showcases', 'get');
		});
		$('.page-next a').click();


		$('.page-pre a').click(function() {
			changePage(-1, 'http://localhost/isd_final/connection/index.php/showcases', 'get');
		});

        $('.right-content-ul > li > .function-div > .delete > a').click(function(){
			$.ajax({
				url: 'http://localhost/isd_final/connection/index.php/showcases/' + $(this).attr('data'),
				type: 'delete',
				data: {
					sess: '13123'
				},
				dataType:'json',
				success: function(res) {
					if(res.deleted == true) {
						alert('Deleted successfully!');
						location.reload();
					} else {
						alert('Deleted failed!');
					}
				}
			})
		})
	})
	User.renderBtn();
</script>

</body>
<!-- Icons -->
<script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
<script>
  feather.replace()
</script>
</html>
